%h1= t '.title'
- @prompt = t '.search_prompt'
.row
  .col-sm-6
    = render 'search_form'
  .col-sm-4.filter-sort__filter
    = render 'filter'
    = render 'sort', sort_options: Client.sort_options(show_vispdat: @show_vispdat)
- if Client.parked.any?
  .alert.alert-warning
    %p.icon-warning
      = "Some clients are parked. "
      = link_to 'See all parked clients.', reports_parked_clients_path
.row.table-utilities
  .col-sm-4
    %p= page_entries_info @clients
  .col-sm-4
    %p.client__current-sort-filter
      Currently sorted by:
      %strong= @sorted_by

%ul.nav.nav-tabs{role: :tablist}
  %li.active{role: :presentation}
    %a{href: '#available-clients', aria: {controls: 'available-clients'}, data: {toggle: :tab}, role: :tab} Available Clients
  %li{role: :presentation}
    %a{href: '#unavailable-clients', aria: {controls: 'unavailable-clients'}, data: {toggle: :tab}, role: :tab} Unavailable Clients
.tab-content
  #available-clients.tab-pane.active{role: :tabpanel}
    .row
      .col-sm-12
        .table-responsive
          %table.table.table__init-cap-header
            %thead
              %tr
                %th Matches
                %th Last Name
                %th First Name
                %th Homeless Since
                %th Days Homeless
                %th Days Homeless in the last three years
                - if @show_vispdat
                  %th VI-SPDAT
                  %th Priority Score
                %th Available
                %th Age
                %th Gender
                %th SSN
                %th Veteran
                %th Chronic
            %tbody
              - @available_clients.each do |client|
                %tr
                  %td.text-right
                    = link_to client_matches_path(client) do
                      .badge.badge-success= @matches[client.id]
                  %td
                    = link_to client_path(client) do
                      = client.last_name
                      = client_data_quality client, :name
                  %td
                    = link_to client_path(client) do
                      = client.first_name
                      = client_data_quality client, :name
                  %td
                    = client.calculated_first_homeless_night.try(:strftime, I18n.t('date.formats.default'))
                  %td= number_with_delimiter(client.days_homeless)
                  %td= number_with_delimiter(client.days_homeless_in_last_three_years)
                  - if @show_vispdat
                    %td
                      = client.vispdat_score
                    %td
                      = client.vispdat_priority_score
                  %td
                    = client.available_text
                  %td
                    %nobr
                      - if client.date_of_birth.present?
                        = client.age 
                      - else
                        unknown
                      = client_data_quality client, :date_of_birth
                  %td
                    = client.gender.try(:text)
                  %td
                    %nobr
                      = masked_ssn client.ssn
                      = client_data_quality client, :ssn
                  %th.text-center
                    = checkmark client.veteran
                  %th.text-center
                    = checkmark client.chronic_homeless

        %p= paginate @available_clients
  #unavailable-clients.tab-pane{role: :tabpanel}
    .row
      .col-sm-12
        .table-responsive
          %table.table.table__init-cap-header
            %thead
              %tr
                %th Matches
                %th Last Name
                %th First Name
                %th Homeless Since
                %th Days Homeless
                %th Days Homeless in the last three years
                - if @show_vispdat
                  %th VI-SPDAT
                  %th Priority Score
                %th Available
                %th Age
                %th Gender
                %th SSN
                %th Veteran
                %th Chronic
            %tbody
              - @unavailable_clients.each do |client|
                %tr
                  %td.text-right
                    = link_to client_matches_path(client) do
                      .badge.badge-success= @matches[client.id]
                  %td
                    = link_to client_path(client) do
                      = client.last_name
                      = client_data_quality client, :name
                  %td
                    = link_to client_path(client) do
                      = client.first_name
                      = client_data_quality client, :name
                  %td
                    = client.calculated_first_homeless_night.try(:strftime, I18n.t('date.formats.default'))
                  %td= number_with_delimiter(client.days_homeless)
                  %td= number_with_delimiter(client.days_homeless_in_last_three_years)
                  - if @show_vispdat
                    %td
                      = client.vispdat_score
                    %td
                      = client.vispdat_priority_score
                  %td
                    = client.available_text
                  %td
                    %nobr
                      - if client.date_of_birth.present?
                        = client.age 
                      - else
                        unknown
                      = client_data_quality client, :date_of_birth
                  %td
                    = client.gender.try(:text)
                  %td
                    %nobr
                      = masked_ssn client.ssn
                      = client_data_quality client, :ssn
                  %th.text-center
                    = checkmark client.veteran
                  %th.text-center
                    = checkmark client.chronic_homeless

        %p= paginate @unavailable_clients
