= simple_form_for [@program, @subprogram] do |f|
  = f.error_notification
  .row
    .col-sm-6
      %h3
        Program Details
      %table.table
        %tr
          %th Name
          %td= @program.name
        %tr
          %th Funding Source
          %td= @program.funding_source_name
        %tr
          %th Contract Start Date
          %td= @program.contract_start_date.try :strftime, '%m/%d/%Y'

  %h3 Sub-Program Details
  .form-inputs
    = f.input :name
    = f.association :housing_subsidy_administrator, label: 'Housing Subsidy Administrator'
    = f.association :service_provider, label: 'Service Provider', required: true 
    = f.association :sub_contractor, label: 'Sub-Contractor'
    %div.form-group.radio_buttons.program-type
      = f.label :program_type, required: true do
        %abbr{'data-original-title' => 'required'}*
        Project, Tenant, or Sponsor-Based?
      - SubProgram.types.each do |t|
        .radio
          = f.label :program_type, for: "sub_program_program_type_#{t[:value].downcase}" do
            = f.radio_button :program_type, t[:value]
            = t[:label]
          - if t[:building]
            = building = f.association :building, label: "#{Building.model_name.human} Name", wrapper_html: {class: 'building form-group__indented-01'}
    
  .well.add-things-boxes.add-things-boxes--rules
    %h3.add-things-boxes--h3 Rules
    = render = render 'requirement_manager/inherited_rules', inheritee: @subprogram

  .form-actions
    = f.button :submit, value: 'Save', class: 'btn btn-primary'

= content_for :page_js do
  :javascript
    $('select').select2();
    
    $('.program-type').on('change', 'input', function() {
      var have_buildings = #{SubProgram.have_buildings};
      $('div.building').hide();
      if($.inArray(this.value, have_buildings) != -1) {
        $(this).parent().siblings('.building').show();
      }
    });
    $('.program-type input:checked').trigger('change');
    

